<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
</head>

<body topmargin="100" leftmargin="150">
{% extends 'index.html' %}
 
{% block content %}
    <form action="" method="POST">
    {% csrf_token %}
        <p> 学号： <input type="text" name="username" id="username" onkeyup="this.value=this.value.replace(/\D/g,'')" onafterpaste="this.value=this.value.replace(/\D/g,'')"/></p>
        <P>输入密码： <input type="password" name="password" id="pw1" onkeyup="validate()"/></P>
        <p>确认密码： <input type="password" name="repassword" id="pw2" onkeyup="validate()"/><span id="tishi"></span></p>
        <p>姓名：<input type="text" name="name" id="name"/><span id="tishi1"></span></p>
        <p>班级：<input type="text" name="class_name" /></p>
        <p>邮箱：<input type="text" name="email" id="email" onkeyup="em()"><span id="tishi2"></span></p>
        <p>验证码：<input type="text" name="valid_code"/></p>
        <p><img id="valid-img" class="valid-img" src="/get_valid_img.png?" alt=""></p>
        <p><input type="submit" value="注册" id="submit" />
        <input type="reset" value="重置"/></p>
    </form> 
    <script>
          function validate() {
              var pw1 = document.getElementById("pw1").value;
              var pw2 = document.getElementById("pw2").value;
              if(pw1 == pw2) {
                  document.getElementById("tishi").innerHTML="<font color='green'>两次密码相同</font>";
                  document.getElementById("submit").disabled = false;
              }
              if(pw1 != pw2 || pw1 == "") {
                  document.getElementById("tishi").innerHTML="<font color='red'>两次密码不相同</font>";
                  document.getElementById("submit").disabled = true;
              }
            }
           function em() {
              var email = document.getElementById("email").value;
              var reg = /^\w+@[a-zA-Z0-9]{2,10}(?:\.[a-z]{2,4}){1,3}$/;
              if(!reg.test(email)||email==""){
                  document.getElementById("tishi2").innerHTML="<font color='red'>邮箱格式不正确</font>";
                  document.getElementById("submit").disabled = true; 
              }
              else{
                  document.getElementById("tishi2").innerHTML="<font color='green'>邮箱格式正确</font>";
                  document.getElementById("submit").disabled = false;
              }
            }
    </script>
 
{% endblock %}
</body>
</html>